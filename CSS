@echo off
setlocal enabledelayedexpansion

:: ===== Configuration =====
set "CSC=C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe"
set "INPUT_FILE=C:\Path\To\Your\input.rpt.SH1"
set "OUTPUT_PDF=C:\Path\To\Output\BankStatement.pdf"
set "ITEXTSHARP=C:\Path\To\itextsharp.dll"

:: ===== Compile and Run =====
echo Compiling bank statement generator...
"%CSC%" /reference:"%ITEXTSHARP%" /out:"%TEMP%\BankStatementGen.exe" "%~dp0BankStatementGenerator.cs"

if errorlevel 1 (
    echo Compilation failed!
    pause
    exit /b 1
)

echo Generating PDF from %INPUT_FILE%...
"%TEMP%\BankStatementGen.exe" "%INPUT_FILE%" "%OUTPUT_PDF%"

if errorlevel 1 (
    echo PDF generation failed!
    pause
    exit /b 1
)

echo PDF created successfully at %OUTPUT_PDF%
timeout /t 3
exit /b 0
